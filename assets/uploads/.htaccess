# Route direct file access through authenticated PHP endpoint
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Block direct directory access
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [F,L]

    # Serve files only via secure endpoint (requires logged-in session)
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^(.+)$ ../../api/secure_file.php?path=assets/uploads/$1 [L,QSA]
</IfModule>

<FilesMatch "^\.">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Deny from all
    </IfModule>
</FilesMatch>
